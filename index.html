<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MOBILE MONEY CALCULATOR</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        
        /* --- General Layout and Component Styles --- */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }
        .card {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .input-group input {
            /* Pushes text right to make space for the currency icon/symbol */
            padding-left: 3rem !important; 
        }

        /* --- Custom Tab Bar and Button Structural Styles --- */
        /* Note: Colors and active state are managed by Tailwind classes and JavaScript */
        .tab-button {
            border-bottom-width: 4px; /* Thicker border for clarity */
            margin-bottom: -2px; /* Pull the button over the divider line */
            z-index: 10;
            cursor: pointer;
            border-color: transparent; /* Default transparent border, actual color set by JS on activation */
        }
        .tab-divider {
            /* This is the gray line under the buttons */
            border-bottom: 2px solid #9ca3af; /* Darker gray (gray-400) */
        }

        /* Custom hover style for the tab buttons using the requested color #04AA6D */
        .tab-button.hover-teal:hover {
            /* This hover style is applied to inactive tabs for a consistent hover effect */
            background-color: #04AA6D !important; /* Override light backgrounds on hover */
            color: white !important; /* Ensure text is visible on dark hover */
        }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen flex items-center justify-center">

    <div class="w-full max-w-lg card bg-white rounded-xl p-6 md:p-10">
        <!-- H1 Title size increased to text-3xl -->
        <h1 class="text-3xl font-extrabold text-sky-700 mb-6 text-center">MOBILE MONEY CALCULATOR</h1>
        
        <!-- Tab Navigation (Enhanced Styling) -->
        <div class="flex tab-divider mb-8">
            <button id="tab-euro-to-taka" 
                    class="tab-button flex-1 py-3 text-center rounded-t-lg transition duration-200 ease-in-out" 
                    onclick="showSection('euroToTaka')">
                Euro to Taka
            </button>
            <button id="tab-taka-to-euro" 
                    class="tab-button flex-1 py-3 text-center rounded-t-lg transition duration-200 ease-in-out" 
                    onclick="showSection('takaToEuro')">
                Taka to Euro
            </button>
        </div>

        <!-- Calculator 1: Euro to Taka Section (SKY BLUE THEME) -->
        <div id="euroToTakaSection" class="calculator-section">
            <h2 class="text-xl font-bold text-gray-700 mb-4">Euro to Taka Calculation</h2>
            <!-- Inputs -->
            <div class="space-y-6">
                
                <!-- MOVED TO TOP: 1. Exchange Rate (BDT per €) -->
                <div class="input-group">
                    <!-- Label increased to text-xl -->
                    <label for="exchangeRate" class="block text-xl font-medium text-gray-700 mb-1 p-2 rounded-t-lg bg-sky-50">1. Exchange Rate (BDT per €)</label>
                    <div class="mt-1 relative rounded-md shadow-sm">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">BDT</span>
                        </div>
                        <input type="number" id="exchangeRate" min="0" step="0.01"
                               class="block w-full rounded-lg border-2 border-sky-400 focus:border-sky-700 focus:ring-sky-700 p-3 sm:text-sm transition duration-150"
                               placeholder="000"> <!-- Placeholder is 000 -->
                    </div>
                </div>

                <!-- MOVED TO BOTTOM: 2. Enter Amount in Euro (€) -->
                <div class="input-group">
                    <!-- Label increased to text-xl -->
                    <label for="euroAmount" class="block text-xl font-medium text-gray-700 mb-1 p-2 rounded-t-lg bg-sky-50">2. Enter Amount in Euro (€)</label>
                    <div class="mt-1 relative rounded-md shadow-sm">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">€</span>
                        </div>
                        <input type="number" id="euroAmount" min="0" step="0.01"
                               class="block w-full rounded-lg border-2 border-sky-400 focus:border-sky-700 focus:ring-sky-700 p-3 sm:text-sm transition duration-150"
                               placeholder="000"> <!-- Placeholder is 000 -->
                    </div>
                </div>
            </div>

            <!-- Quick Select Buttons for Euro (UPDATED with smaller denominations) -->
            <div class="w-full mt-6"> <!-- Added mt-6 for spacing after the inputs -->
                <p class="text-sm font-medium text-gray-500 mb-2">Quick Select (€):</p>
                <div class="flex flex-wrap gap-2">
                    <!-- NEW SMALLER VALUES ADDED -->
                    <button onclick="setAmount(10, 'euro')" class="text-xs px-3 py-1 bg-sky-100 text-sky-700 rounded-lg hover:bg-sky-200 transition duration-150 border border-sky-300">€10</button>
                    <button onclick="setAmount(15, 'euro')" class="text-xs px-3 py-1 bg-sky-100 text-sky-700 rounded-lg hover:bg-sky-200 transition duration-150 border border-sky-300">€15</button>
                    <button onclick="setAmount(20, 'euro')" class="text-xs px-3 py-1 bg-sky-100 text-sky-700 rounded-lg hover:bg-sky-200 transition duration-150 border border-sky-300">€20</button>
                    <button onclick="setAmount(25, 'euro')" class="text-xs px-3 py-1 bg-sky-100 text-sky-700 rounded-lg hover:bg-sky-200 transition duration-150 border border-sky-300">€25</button>
                    <button onclick="setAmount(30, 'euro')" class="text-xs px-3 py-1 bg-sky-100 text-sky-700 rounded-lg hover:bg-sky-200 transition duration-150 border border-sky-300">€30</button>
                    <button onclick="setAmount(35, 'euro')" class="text-xs px-3 py-1 bg-sky-100 text-sky-700 rounded-lg hover:bg-sky-200 transition duration-150 border border-sky-300">€35</button>
                    <button onclick="setAmount(40, 'euro')" class="text-xs px-3 py-1 bg-sky-100 text-sky-700 rounded-lg hover:bg-sky-200 transition duration-150 border border-sky-300">€40</button>
                    <!-- EXISTING VALUES -->
                    <button onclick="setAmount(50, 'euro')" class="text-xs px-3 py-1 bg-sky-100 text-sky-700 rounded-lg hover:bg-sky-200 transition duration-150 border border-sky-300">€50</button>
                    <button onclick="setAmount(100, 'euro')" class="text-xs px-3 py-1 bg-sky-100 text-sky-700 rounded-lg hover:bg-sky-200 transition duration-150 border border-sky-300">€100</button>
                    <button onclick="setAmount(150, 'euro')" class="text-xs px-3 py-1 bg-sky-100 text-sky-700 rounded-lg hover:bg-sky-200 transition duration-150 border border-sky-300">€150</button>
                    <button onclick="setAmount(200, 'euro')" class="text-xs px-3 py-1 bg-sky-100 text-sky-700 rounded-lg hover:bg-sky-200 transition duration-150 border border-sky-300">€200</button>
                    <button onclick="setAmount(250, 'euro')" class="text-xs px-3 py-1 bg-sky-100 text-sky-700 rounded-lg hover:bg-sky-200 transition duration-150 border border-sky-300">€250</button>
                    <button onclick="setAmount(299, 'euro')" class="text-xs px-3 py-1 bg-sky-100 text-sky-700 rounded-lg hover:bg-sky-200 transition duration-150 border border-sky-300">€299</button>
                </div>
            </div>
            <!-- End Quick Select Buttons for Euro -->

            <!-- Clear Button -->
            <button onclick="clearInputs()" class="w-full bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition duration-150 shadow-md mt-6">
                Clear Euro/Taka Data
            </button>

            <!-- Output Section -->
            <div class="mt-8 pt-6 border-t border-sky-200 space-y-3">
                <div class="flex justify-between items-center p-3 bg-sky-100 rounded-lg">
                    <!-- Text size increased to text-lg -->
                    <span class="text-lg font-medium text-sky-800">Gross Value (Fee Tier Check)</span>
                    <span id="grossTakaOutput" class="text-lg font-semibold text-sky-900">0.00 BDT</span>
                </div>
                <!-- Fee deduction is highlighted in Red (Warning color) -->
                <div class="flex justify-between items-center p-3 bg-red-100 rounded-lg">
                    <!-- Text size increased to text-lg -->
                    <span class="text-lg font-medium text-red-800 font-semibold">Fixed Charge Deducted (EURO)</span>
                    <span id="feeAmountEuroOutput" class="text-lg font-extrabold text-red-900">0.00 €</span>
                </div>
                <div class="flex justify-between items-center p-4 bg-sky-100 border-l-4 border-sky-700 rounded-lg">
                    <span class="text-lg font-bold text-sky-800">Final BDT Output</span>
                    <span id="finalTakaOutput" class="text-2xl font-extrabold text-sky-900">0.00 BDT</span>
                </div>

                <!-- NEW: Alternative Output Section - Hidden by default -->
                <div id="alternativeTakaOutputBox" class="flex justify-between items-center p-3 bg-yellow-100 rounded-lg hidden transition duration-300 ease-in-out">
                    <span id="alternativeTakaLabel" class="text-lg font-medium text-yellow-800">Alternative Output (Lower Fee Tier)</span>
                    <span id="alternativeTakaOutput" class="text-lg font-semibold text-yellow-900">0.00 BDT</span>
                </div>
                <!-- END NEW OUTPUT -->
            </div>
        </div>

        <!-- Calculator 2: Taka to Euro Section (EMERALD GREEN THEME) -->
        <div id="takaToEuroSection" class="calculator-section hidden">
            <h2 class="text-xl font-bold text-gray-700 mb-4">Taka to Euro Calculation</h2>
            <!-- Inputs -->
            <div class="space-y-6">
                 <div class="input-group">
                    <!-- Label theme changed to emerald -->
                    <label for="bdtToEuroRate" class="block text-xl font-medium text-gray-700 mb-1 p-2 rounded-t-lg bg-emerald-50">1. Exchange Rate (BDT per €)</label>
                    <div class="mt-1 relative rounded-md shadow-sm">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">BDT</span>
                        </div>
                        <!-- Input border changed to emerald -->
                        <input type="number" id="bdtToEuroRate" min="0" step="0.01"
                               class="block w-full rounded-lg border-2 border-emerald-400 focus:border-emerald-700 focus:ring-emerald-700 p-3 sm:text-sm transition duration-150"
                               placeholder="000"> <!-- Placeholder is 000 -->
                    </div>
                </div>

                <div class="input-group">
                    <!-- Label theme changed to emerald -->
                    <label for="bdtToEuroAmount" class="block text-xl font-medium text-gray-700 mb-1 p-2 rounded-t-lg bg-emerald-50">2. Enter Amount in Taka (BDT)</label>
                    <div class="mt-1 relative rounded-md shadow-sm">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <span class="text-gray-500 sm:text-sm">BDT</span>
                        </div>
                        <!-- Input border changed to emerald -->
                        <input type="number" id="bdtToEuroAmount" min="0" step="0.01"
                               class="block w-full rounded-lg border-2 border-emerald-400 focus:border-emerald-700 focus:ring-emerald-700 p-3 sm:text-sm transition duration-150"
                               placeholder="000"> <!-- Placeholder is 000 -->
                    </div>
                </div>

                <!-- Quick Select Buttons for BDT (THEME CHANGED TO EMERALD) -->
                <div class="w-full">
                    <p class="text-sm font-medium text-gray-500 mb-2">Quick Select (BDT):</p>
                    <div class="flex flex-wrap gap-1">
                        <button onclick="setAmount(1000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">1000 BDT</button>
                        <button onclick="setAmount(2000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">2000 BDT</button>
                        <button onclick="setAmount(3000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">3000 BDT</button>
                        <button onclick="setAmount(4000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">4000 BDT</button>
                        <button onclick="setAmount(5000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">5000 BDT</button>
                        <button onclick="setAmount(6000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">6000 BDT</button>
                        <button onclick="setAmount(7000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">7000 BDT</button>
                        <button onclick="setAmount(8000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">8000 BDT</button>
                        <button onclick="setAmount(9000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">9000 BDT</button>
                        <button onclick="setAmount(10000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">10000 BDT</button>
                        <button onclick="setAmount(11000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">11000 BDT</button>
                        <button onclick="setAmount(12000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">12000 BDT</button>
                        <button onclick="setAmount(13000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">13000 BDT</button>
                        <button onclick="setAmount(14000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">14000 BDT</button>
                        <button onclick="setAmount(15000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">15000 BDT</button>
                        <button onclick="setAmount(16000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">16000 BDT</button>
                        <button onclick="setAmount(17000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">17000 BDT</button>
                        <button onclick="setAmount(18000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">18000 BDT</button>
                        <button onclick="setAmount(19000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">19000 BDT</button>
                        <button onclick="setAmount(20000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">20000 BDT</button>
                        <button onclick="setAmount(25000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">25000 BDT</button>
                        <button onclick="setAmount(30000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">30000 BDT</button>
                        <button onclick="setAmount(50000, 'bdt')" class="text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg hover:bg-emerald-200 transition duration-150 border border-emerald-300">50000 BDT</button>
                    </div>
                </div>
                <!-- End Quick Select Buttons for BDT -->


            </div>
            
            <!-- Clear Button -->
            <button onclick="clearInputs()" class="w-full bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition duration-150 shadow-md mt-6">
                Clear Euro/Taka Data
            </button>

            <!-- Output Section (THEME CHANGED TO EMERALD) -->
            <div class="mt-8 pt-6 border-t border-emerald-200 space-y-3">
                <div class="flex justify-between items-center p-3 bg-emerald-100 rounded-lg">
                    <!-- Text size increased to text-lg -->
                    <span class="text-lg font-medium text-emerald-800">BDT Amount with 2% Charge</span>
                    <span id="bdtWithPercentOutput" class="text-lg font-semibold text-emerald-900">0.00 BDT</span>
                </div>
                <!-- Fixed charge is highlighted in Red (Warning color), kept for contrast -->
                <div class="flex justify-between items-center p-3 bg-red-100 rounded-lg">
                    <!-- Text size increased to text-lg -->
                    <span class="text-lg font-medium text-red-800 font-semibold">Fixed Charge Added (EURO)</span>
                    <span id="fixedEuroChargeBdtToEuroOutput" class="text-lg font-extrabold text-red-900">0.00 €</span>
                </div>
                <div class="flex justify-between items-center p-4 bg-emerald-100 border-l-4 border-emerald-700 rounded-lg">
                    <span class="text-lg font-bold text-emerald-800">Total Euro Required</span>
                    <span id="totalEurosOutput" class="text-2xl font-extrabold text-emerald-900">0.00 €</span>
                </div>
            </div>
        </div>

        <!-- DEVELOPER CREDIT START (Moved to bottom of card) -->
        <div class="mt-8 pt-4 border-t border-gray-200 text-center text-sm text-gray-500">
            Developed by: Syed Nadir Ahmed
            <div class="flex justify-center space-x-4 mt-1">
                <a href="https://github.com/SyedNadirAhmed" target="_blank" class="text-blue-500 hover:text-blue-700 transition duration-150">GitHub</a>
                <a href="https://bd.linkedin.com/in/syed-nadir-ahmed-20156213a" target="_blank" class="text-blue-500 hover:text-blue-700 transition duration-150">LinkedIn</a>
            </div>
        </div>
        <!-- DEVELOPER CREDIT END -->
        
    </div>

    <script>
        // --- Shared Fee Logic (Used by both calculators) ---
        
        // Define all fee tiers with their start boundary (inclusive), fee, and a name for display.
        const FEE_TIERS = [
            { start: 0, fee: 1.50, name: "1-1000 BDT" },
            { start: 1001, fee: 2.00, name: "1001-1500 BDT" },
            { start: 1501, fee: 2.50, name: "1501-3000 BDT" },
            { start: 3001, fee: 3.00, name: "3001-7000 BDT" },
            { start: 7001, fee: 4.00, name: "7001-9000 BDT" },
            { start: 9001, fee: 4.50, name: "9001-30000 BDT" },
            { start: 30001, fee: 5.50, name: "30001-50000 BDT" },
            { start: 50001, fee: 6.50, name: "50001-100000 BDT" },
            // Fee is 0 above 100000 BDT
        ];

        /**
         * Determines the fixed Euro fee based on the BDT value.
         * NOTE: This original function is kept to support the Taka to Euro calculation.
         * @param {number} bdtValue - The BDT amount used for tier checking (Gross for E->T, Input for T->E).
         * @returns {number} The fixed fee amount in Euro.
         */
        function getFixedEuroFeeByTaka(bdtValue) {
            if (isNaN(bdtValue) || bdtValue <= 0) return 0;
            
            // Find the fee using the defined tiers
            let fee = 0;
            for (let i = FEE_TIERS.length - 1; i >= 0; i--) {
                if (bdtValue >= FEE_TIERS[i].start) {
                    fee = FEE_TIERS[i].fee;
                    break;
                }
            }
            return fee;
        }

        /**
         * Finds the current and previous fee details based on BDT value for E->BDT calculation.
         * @param {number} bdtValue - The BDT amount.
         * @returns {{ currentFee: number, previousFee: number | null, previousTierName: string | null }}
         */
        function getFeeDetails(bdtValue) {
            let currentFee = 0;
            let previousFee = null;
            let previousTierName = null;
            
            let currentIndex = -1;
            for (let i = FEE_TIERS.length - 1; i >= 0; i--) {
                if (bdtValue >= FEE_TIERS[i].start) {
                    currentIndex = i;
                    currentFee = FEE_TIERS[i].fee;
                    break;
                }
            }
            
            if (currentIndex > 0) {
                // Get the details of the immediately preceding (lower) tier
                previousFee = FEE_TIERS[currentIndex - 1].fee;
                previousTierName = FEE_TIERS[currentIndex - 1].name;
            }
            
            return { currentFee, previousFee, previousTierName };
        }


        // --- Calculator 1: Euro to Taka (E -> BDT) ---

        function calculateEuroToTaka() {
            // Note: The input IDs remain the same, only their position in the HTML changed
            const euroAmount = parseFloat(document.getElementById('euroAmount').value) || 0;
            const exchangeRate = parseFloat(document.getElementById('exchangeRate').value) || 0;

            const grossTakaOutput = document.getElementById('grossTakaOutput');
            const feeAmountEuroOutput = document.getElementById('feeAmountEuroOutput');
            const finalTakaOutput = document.getElementById('finalTakaOutput');
            const alternativeTakaOutputBox = document.getElementById('alternativeTakaOutputBox');
            const alternativeTakaOutput = document.getElementById('alternativeTakaOutput');
            const alternativeTakaLabel = document.getElementById('alternativeTakaLabel');

            const defaultOutput = '0.00';
            
            if (euroAmount <= 0 || exchangeRate <= 0) {
                grossTakaOutput.textContent = defaultOutput + ' BDT';
                feeAmountEuroOutput.textContent = defaultOutput + ' €';
                finalTakaOutput.textContent = defaultOutput + ' BDT';
                alternativeTakaOutputBox.classList.add('hidden');
                return;
            }

            const grossTaka = euroAmount * exchangeRate; 
            
            // Get current and previous fee details based on Gross Taka
            const feeDetails = getFeeDetails(grossTaka);
            const feeAmountEuro = feeDetails.currentFee;
            const netEuro = Math.max(0, euroAmount - feeAmountEuro);
            const finalTaka = netEuro * exchangeRate;

            // --- ALTERNATIVE OUTPUT LOGIC (The user's requested second output) ---
            let isAlternativeOutputShown = false;
            const previousFee = feeDetails.previousFee;

            // The alternative output is shown if there is a previous (lower) fee tier.
            // This covers all user examples where the gross value crossed a tier boundary.
            if (previousFee !== null && feeAmountEuro > previousFee) {
                // Calculate the alternative output using the previous (lower) fee
                const alternativeNetEuro = Math.max(0, euroAmount - previousFee);
                const alternativeFinalTaka = alternativeNetEuro * exchangeRate;
                
                // Update the UI for the alternative output
                alternativeTakaOutputBox.classList.remove('hidden');
                alternativeTakaLabel.textContent = `Alternative Output (Fee: ${previousFee.toFixed(2)}€, Tier: ${feeDetails.previousTierName})`;
                alternativeTakaOutput.textContent = `${alternativeFinalTaka.toFixed(2)} BDT`;
                isAlternativeOutputShown = true;
            }
            
            if (!isAlternativeOutputShown) {
                alternativeTakaOutputBox.classList.add('hidden');
            }


            // --- Update the UI (Standard Output) ---
            grossTakaOutput.textContent = `${grossTaka.toFixed(2)} BDT`;
            feeAmountEuroOutput.textContent = `${feeAmountEuro.toFixed(2)} €`;
            finalTakaOutput.textContent = `${finalTaka.toFixed(2)} BDT`;
        }

        // --- Calculator 2: Taka to Euro (BDT -> E) ---

        function calculateTakaToEuro() {
            const bdtAmount = parseFloat(document.getElementById('bdtToEuroAmount').value) || 0;
            const currentRate = parseFloat(document.getElementById('bdtToEuroRate').value) || 0; // BDT per Euro

            const bdtWithPercentOutput = document.getElementById('bdtWithPercentOutput');
            const fixedEuroChargeBdtToEuroOutput = document.getElementById('fixedEuroChargeBdtToEuroOutput');
            const totalEurosOutput = document.getElementById('totalEurosOutput');

            const defaultOutput = '0.00';
            
            if (bdtAmount <= 0 || currentRate <= 0) {
                bdtWithPercentOutput.textContent = defaultOutput + ' BDT';
                fixedEuroChargeBdtToEuroOutput.textContent = defaultOutput + ' €';
                totalEurosOutput.textContent = defaultOutput + ' €';
                return;
            }

            const bdtWith2Percent = bdtAmount * 1.02;
            const fixedEuroFee = getFixedEuroFeeByTaka(bdtAmount); // Uses the standard fee function
            const eurosFromBdt = bdtWith2Percent / currentRate;
            const totalEuros = eurosFromBdt + fixedEuroFee;

            // --- Update the UI ---
            bdtWithPercentOutput.textContent = `${bdtWith2Percent.toFixed(2)} BDT`;
            fixedEuroChargeBdtToEuroOutput.textContent = `${fixedEuroFee.toFixed(2)} €`;
            totalEurosOutput.textContent = `${totalEuros.toFixed(2)} €`;
        }
        
        // --- Quick Select Function (NEW) ---
        /**
         * Sets the amount input field based on currency and triggers calculation.
         * @param {number} amount - The amount to set.
         * @param {'euro' | 'bdt'} currency - The currency type.
         */
        function setAmount(amount, currency) {
            if (currency === 'euro') {
                document.getElementById('euroAmount').value = amount;
                calculateEuroToTaka();
            } else if (currency === 'bdt') {
                document.getElementById('bdtToEuroAmount').value = amount;
                calculateTakaToEuro();
            }
        }


        // --- Clear Function (Updated to clear all values) ---
        function clearInputs() {
            document.getElementById('euroAmount').value = '';
            document.getElementById('bdtToEuroAmount').value = '';
            document.getElementById('exchangeRate').value = ''; 
            document.getElementById('bdtToEuroRate').value = '';
            calculateEuroToTaka();
            calculateTakaToEuro();
            
            const activeSection = document.querySelector('.calculator-section:not(.hidden)');
            if (activeSection) {
                const firstInput = activeSection.querySelector('input[type="number"]');
                if (firstInput) {
                    firstInput.focus();
                }
            }
        }


        // --- UI/Event Handlers (Updated for Distinct and Darker Tab Backgrounds) ---

        const euroInput = document.getElementById('euroAmount');
        const rateInput = document.getElementById('exchangeRate');
        const bdtToEuroAmountInput = document.getElementById('bdtToEuroAmount');
        const bdtToEuroRateInput = document.getElementById('bdtToEuroRate');

        function showSection(sectionId) {
            // Hide/Show Section
            document.querySelectorAll('.calculator-section').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(sectionId + 'Section').classList.remove('hidden');

            // --- Define all possible theme classes for cleanup ---
            // Added 'emerald' colors and removed 'red' from the shared cleanup list
            const allColorClasses = [
                // Theme Colors
                'text-sky-700', 'border-sky-500', 'bg-sky-100', 'text-emerald-700', 'border-emerald-500', 'bg-emerald-100',
                'bg-sky-600', 'bg-sky-700', 'bg-sky-400', 'bg-sky-50', 
                'bg-emerald-600', 'bg-emerald-700', 'bg-emerald-400', 'bg-emerald-50', 
                'bg-sky-300', 'bg-emerald-300',
                'border-sky-400', 'focus:border-sky-600', 'focus:ring-sky-600', 'focus:border-sky-700', 'focus:ring-sky-700',
                'border-emerald-400', 'focus:border-emerald-600', 'focus:ring-emerald-600', 'focus:border-emerald-700', 'focus:ring-emerald-700',
                'border-sky-600', 'border-sky-700', 'text-sky-800', 'text-sky-900',
                'border-emerald-600', 'border-emerald-700', 'text-emerald-800', 'text-emerald-900',
                // Red classes for fee warnings (kept separate for logic below)
                'bg-red-50', 'bg-red-100', 'border-red-400', 'focus:border-red-700', 'focus:ring-red-700', 'text-red-800', 'text-red-900',
                // Yellow classes for alternative output
                'bg-yellow-100', 'text-yellow-800', 'text-yellow-900',
                // Generic classes used for state
                'text-white', 'font-bold', 'shadow-lg', 'text-gray-600', 'text-gray-800', 'border-transparent', 'shadow-md', 'hover-teal',
                // Label-specific classes
                'p-2', 'rounded-t-lg', 'text-sm', 'text-lg', 'text-xl', 'text-2xl', 'text-3xl', 'text-[32px]', 'text-center'
            ];
            
            // Define tab elements
            const tabEuro = document.getElementById('tab-euro-to-taka');
            const tabTaka = document.getElementById('tab-taka-to-euro');

            // --- 1. Reset both tabs to their *distinct* inactive styles ---

            // Reset Euro Tab (Medium Sky Blue Inactive)
            tabEuro.classList.remove(...allColorClasses);
            tabEuro.classList.add('text-white', 'border-transparent', 'bg-sky-400', 'hover-teal'); 

            // Reset Taka Tab (Medium Emerald Inactive)
            tabTaka.classList.remove(...allColorClasses);
            tabTaka.classList.add('text-white', 'border-transparent', 'bg-emerald-400', 'hover-teal'); 

            
            // --- 2. Update H1 color and clean up input borders ---
            const h1 = document.querySelector('h1');
            h1.classList.remove(...allColorClasses); 
            
            // Select output boxes for color update
            const finalTakaOutputBox = document.querySelector('#euroToTakaSection .border-l-4');
            const totalEurosOutputBox = document.querySelector('#takaToEuroSection .border-l-4');

            // Clean up all non-fee related input borders
            const inputElements = [euroInput, rateInput, bdtToEuroAmountInput, bdtToEuroRateInput];
            inputElements.forEach(input => input.classList.remove(...allColorClasses.filter(c => c.startsWith('border-') || c.startsWith('focus:'))));
            
            // Clean up previous output box styling
            const outputBoxes = [finalTakaOutputBox, totalEurosOutputBox];
            outputBoxes.forEach(box => {
                box.classList.remove(...allColorClasses);
                const spans = box.querySelectorAll('span');
                spans.forEach(span => span.classList.remove(...allColorClasses));
            });


            // --- 3. Activate the selected tab and set its darker theme colors ---
            const activeTab = document.getElementById('tab-' + sectionId);
            
            if (sectionId === 'euroToTaka') {
                // Activate Euro tab (Dark Blue: bg-sky-700)
                activeTab.classList.remove('text-white', 'bg-sky-400'); // Remove inactive styles
                activeTab.classList.add('text-white', 'border-sky-700', 'bg-sky-700', 'font-bold', 'shadow-lg');
                h1.classList.add('text-sky-700', 'text-center'); // Added text-center here
                
                // Set E->T input and output colors (Sky Blue)
                euroInput.classList.add('border-sky-400', 'focus:border-sky-700', 'focus:ring-sky-700');
                rateInput.classList.add('border-sky-400', 'focus:border-sky-700', 'focus:ring-sky-700');
                
                // Set E->T final output box to Sky Blue theme
                finalTakaOutputBox.classList.add('bg-sky-100', 'border-l-4', 'border-sky-700');
                finalTakaOutputBox.querySelector('span:first-child').classList.add('text-lg', 'font-bold', 'text-sky-800');
                finalTakaOutputBox.querySelector('span:last-child').classList.add('text-2xl', 'font-extrabold', 'text-sky-900');

                // Recalculate upon section change
                calculateEuroToTaka();

            } else if (sectionId === 'takaToEuro') {
                // Activate Taka tab (Dark Emerald: bg-emerald-700)
                activeTab.classList.remove('text-white', 'bg-emerald-400'); // Remove inactive styles
                activeTab.classList.add('text-white', 'border-emerald-700', 'bg-emerald-700', 'font-bold', 'shadow-lg');
                h1.classList.add('text-emerald-700', 'text-center'); // Added text-center here
                
                // Set T->E input and output colors (Emerald Green)
                bdtToEuroRateInput.classList.add('border-emerald-400', 'focus:border-emerald-700', 'focus:ring-emerald-700');
                bdtToEuroAmountInput.classList.add('border-emerald-400', 'focus:border-emerald-700', 'focus:ring-emerald-700');
                
                // Set T->E final output box to Emerald theme
                totalEurosOutputBox.classList.add('bg-emerald-100', 'border-l-4', 'border-emerald-700');
                totalEurosOutputBox.querySelector('span:first-child').classList.add('text-lg', 'font-bold', 'text-emerald-800');
                totalEurosOutputBox.querySelector('span:last-child').classList.add('text-2xl', 'font-extrabold', 'text-emerald-900');
                
                // Also update the BDT 2% charge box to the emerald theme
                const bdtWithPercentOutputBox = document.querySelector('#takaToEuroSection > .mt-8 > div:nth-child(1)');
                bdtWithPercentOutputBox.classList.remove('bg-red-100'); // Ensure we remove any previous red setting
                bdtWithPercentOutputBox.classList.add('bg-emerald-100');
                bdtWithPercentOutputBox.querySelector('span:first-child').classList.remove('text-red-800');
                bdtWithPercentOutputBox.querySelector('span:first-child').classList.add('text-emerald-800');
                bdtWithPercentOutputBox.querySelector('span:last-child').classList.remove('text-red-900');
                bdtWithPercentOutputBox.querySelector('span:last-child').classList.add('text-emerald-900');


                // Recalculate upon section change
                calculateTakaToEuro();
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Attach listeners
            euroInput.addEventListener('input', calculateEuroToTaka);
            rateInput.addEventListener('input', calculateEuroToTaka);
            bdtToEuroAmountInput.addEventListener('input', calculateTakaToEuro);
            bdtToEuroRateInput.addEventListener('input', calculateTakaToEuro);

            // Ensure initial state is calculated (will be 0.00 since fields are empty)
            showSection('euroToTaka');
        });
    </script>
</body>
</html>
